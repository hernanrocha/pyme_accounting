<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_move_line_tree_grouped_partner" model="ir.ui.view">
        <field name="name">account.move.line.tree.grouped.partner</field>
        <field name="model">account.move.line</field>
        <field name="arch" type="xml">
            <tree string="Libro Mayor" create="false" expand="context.get('expand', False)" multi_edit="1">
                <field name="date" string="Fecha" readonly="1"/>
                <field name="move_id" string="Asiento" width="3"/>
                <field name="account_id" optional="show" options="{'no_open': True, 'no_create': True}"
                        domain="[('company_id', '=', company_id)]"
                        groups="account.group_account_readonly"/>

                <field name="name" string="Descripción" width="3"/>
                <field name="debit" sum="Débito" readonly="1"/>
                <field name="credit" sum="Crédito" readonly="1"/>
                <field name="balance" sum="Saldo" readonly="1"/>
                <field name="amount_currency" readonly="1" groups="base.group_multi_currency"/>
                <field name="tax_ids" widget="many2many_tags" width="0.5" optional="hide" readonly="1"/>
                <field name="tax_tag_ids" widget="many2many_tags" width="0.5" optional="hide" string="Tax Grids"
                        options="{'no_open': True, 'no_create': True}"
                        domain="[('applicability', '=', 'taxes')]"/>

                <field name="partner_id" invisible="1" readonly="1"/>
                <field name="company_id" invisible="1" groups="base.group_multi_company" options="{'no_create': True}" />
                <field name="statement_id" invisible="1"/>
                <field name="ref" invisible="1"/>
                <field name="currency_id" readonly="1" invisible="1" />
                <field name="company_currency_id" invisible="1"/>
                <field name="parent_state" invisible="1"/>
                <field name="reconciled" invisible="1"/>
                <field name="matching_number" invisible="1"/>
                <field name="reconcile_model_id" invisible="1"/>
                <field name="date_maturity" invisible="1"/>
                <field name="analytic_account_id" invisible="1" groups="analytic.group_analytic_accounting" attrs="{'readonly':[('parent_state','=','posted')]}"/>
                <field name="analytic_tag_ids" invisible="1" readonly="1" groups="analytic.group_analytic_tags"/>
                <field name="cumulated_balance" invisible="1"/>

                <groupby name="move_id">
                    <field name="state" invisible="1"/>
                    <button name="edit" type="edit" icon="fa-edit" title="Edit"/>
                    <button name="action_post" states="draft" icon="fa-check" title="Post" type="object" groups="account.group_account_invoice"/>
                    <button name="%(account.action_view_account_move_reversal)d" states="posted" title="Reverse" icon="fa-refresh" type="action" groups="account.group_account_invoice"/>
                    <!-- <button name="action_duplicate" icon="fa-files-o" title="Duplicate" type="object" groups="account.group_account_invoice"/> -->
                </groupby>
            </tree>
        </field>
    </record>

    <record id="action_account_libro_mayor" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_account': 1, 'search_default_posted':1}</field>
        <field name="name">Libro Mayor</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">[('display_type', 'not in', ('line_section', 'line_note'))]</field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter_with_root_selection"/>
        <field name="view_mode">tree</field>
    </record>

    <record id="action_account_cta_cte_clientes" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_partner': 1, 'search_default_posted':1, 'search_default_payable':1, 'search_default_receivable':1, 'search_default_unreconciled':1}</field>
        <field name="name">Cuenta Corriente de Clientes</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">
        [
            ('display_type', 'not in', ('line_section', 'line_note')),
            ('move_id.move_type', 'in', ('out_invoice', 'out_refund')),
        ]
        </field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter"/>
        <field name="view_mode">tree</field>
    </record>

    <record id="action_account_cta_cte_proveedores" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_partner': 1, 'search_default_posted':1, 'search_default_payable':1, 'search_default_receivable':1, 'search_default_unreconciled':1}</field>
        <field name="name">Cuenta Corriente de Proveedores</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">
        [
            ('display_type', 'not in', ('line_section', 'line_note')),
            ('move_id.move_type', 'in', ('in_invoice', 'in_refund')),
        ]
        </field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter"/>
        <field name="view_mode">tree</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- TODO: filtrar por compañia. tal vez ir.rule? -->
    <record id="action_configuration_plan_contable" model="ir.actions.act_window">
        <field name="name">Plan Contable</field>
        <field name="res_model">account.account</field>
        <field name="view_mode">tree</field>
    </record>
    
    <!-- TODO: Mover a un archivo propio -->
    <record id="action_configuration_tipos_comprobante" model="ir.actions.act_window">
        <field name="name">Tipos de Comprobante</field>
        <field name="res_model">l10n_latam.document.type</field>
        <field name="view_mode">tree</field>
    </record>

</odoo>