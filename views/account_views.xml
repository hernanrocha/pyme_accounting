<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_move_line_tree_grouped_partner" model="ir.ui.view">
        <field name="name">account.move.line.tree.grouped.partner</field>
        <field name="model">account.move.line</field>
        <field name="arch" type="xml">
            <tree string="Libro Mayor" create="false" expand="context.get('expand', False)" multi_edit="1">
                <field name="date" string="Fecha" readonly="1"/>
                <field name="move_id" string="Asiento" width="3"/>
                <field name="account_id" optional="show" options="{'no_open': True, 'no_create': True}"
                        domain="[('company_id', '=', company_id)]"
                        groups="account.group_account_readonly"/>

                <field name="name" string="Descripción" width="3"/>
                <field name="debit" sum="Débito" readonly="1"/>
                <field name="credit" sum="Crédito" readonly="1"/>
                <field name="balance" sum="Saldo" readonly="1"/>
                <field name="amount_currency" readonly="1" groups="base.group_multi_currency"/>
                <field name="tax_ids" widget="many2many_tags" width="0.5" optional="hide" readonly="1"/>
                <field name="tax_tag_ids" widget="many2many_tags" width="0.5" optional="hide" string="Tax Grids"
                        options="{'no_open': True, 'no_create': True}"
                        domain="[('applicability', '=', 'taxes')]"/>

                <field name="partner_id" invisible="1" readonly="1"/>
                <field name="company_id" invisible="1" groups="base.group_multi_company" options="{'no_create': True}" />
                <field name="statement_id" invisible="1"/>
                <field name="ref" invisible="1"/>
                <field name="currency_id" readonly="1" invisible="1" />
                <field name="company_currency_id" invisible="1"/>
                <field name="parent_state" invisible="1"/>
                <field name="reconciled" invisible="1"/>
                <field name="matching_number" invisible="1"/>
                <field name="reconcile_model_id" invisible="1"/>
                <field name="date_maturity" invisible="1"/>
                <field name="analytic_account_id" invisible="1" groups="analytic.group_analytic_accounting" attrs="{'readonly':[('parent_state','=','posted')]}"/>
                <field name="analytic_tag_ids" invisible="1" readonly="1" groups="analytic.group_analytic_tags"/>
                <field name="cumulated_balance" invisible="1"/>

                <groupby name="move_id">
                    <field name="state" invisible="1"/>
                    <button name="edit" type="edit" icon="fa-edit" title="Edit"/>
                    <button name="action_post" states="draft" icon="fa-check" title="Post" type="object" groups="account.group_account_invoice"/>
                    <button name="%(account.action_view_account_move_reversal)d" states="posted" title="Reverse" icon="fa-refresh" type="action" groups="account.group_account_invoice"/>
                    <!-- <button name="action_duplicate" icon="fa-files-o" title="Duplicate" type="object" groups="account.group_account_invoice"/> -->
                </groupby>
            </tree>
        </field>
    </record>

    <record id="action_account_libro_mayor" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_account': 1, 'search_default_posted':1}</field>
        <field name="name">Libro Mayor</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">[('display_type', 'not in', ('line_section', 'line_note'))]</field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter_with_root_selection"/>
        <field name="view_mode">tree</field>
    </record>

    <record id="action_account_cta_cte_clientes" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_partner': 1, 'search_default_posted':1, 'search_default_payable':1, 'search_default_receivable':1, 'search_default_unreconciled':1}</field>
        <field name="name">Cuenta Corriente de Clientes</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">
        [
            ('display_type', 'not in', ('line_section', 'line_note')),
            ('move_id.move_type', 'in', ('out_invoice', 'out_refund')),
        ]
        </field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter"/>
        <field name="view_mode">tree</field>
    </record>

    <record id="action_account_cta_cte_proveedores" model="ir.actions.act_window">
        <field name="context">{'journal_type':'general', 'search_default_group_by_partner': 1, 'search_default_posted':1, 'search_default_payable':1, 'search_default_receivable':1, 'search_default_unreconciled':1}</field>
        <field name="name">Cuenta Corriente de Proveedores</field>
        <field name="res_model">account.move.line</field>
        <field name="domain">
        [
            ('display_type', 'not in', ('line_section', 'line_note')),
            ('move_id.move_type', 'in', ('in_invoice', 'in_refund')),
        ]
        </field>
        <field name="view_id" ref="view_move_line_tree_grouped_partner"/>
        <field name="search_view_id" ref="account.view_account_move_line_filter"/>
        <field name="view_mode">tree</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- TODO: filtrar por compañia. tal vez ir.rule? -->
    <record id="action_configuration_plan_contable" model="ir.actions.act_window">
        <field name="name">Plan Contable</field>
        <field name="res_model">account.account</field>
        <field name="view_mode">tree</field>
    </record>
    
    <!-- TODO: Mover a un archivo propio -->
    <record id="action_configuration_tipos_comprobante" model="ir.actions.act_window">
        <field name="name">Tipos de Comprobante</field>
        <field name="res_model">l10n_latam.document.type</field>
        <field name="view_mode">tree</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Deducciones ARBA - TREE VIEW -->
    <record id="view_taxes_arba_deducciones_tree" model="ir.ui.view">
        <field name="name">l10n_ar.impuestos.deduccion.tree</field>
        <field name="model">l10n_ar.impuestos.deduccion</field>
        <field name="arch" type="xml">
            <tree>
                <field name="tax" invisible="1" />
                <field name="date" />
                <field name="amount" />
                <field name="control" />
                <field name="cuit" />
                <field name="invoice_pos" />
                <field name="invoice_number" />
                <field name="invoice_description" />
                <field name="description" />
                <field name="apply_date" />
                <field name="publish_date" />
                <field name="type" />
                <field name="state" />
            </tree>
        </field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Deducciones ARBA - WINDOW -->
    <record id="action_taxes_arba_deducciones" model="ir.actions.act_window">
        <field name="name">Deducciones ARBA</field>
        <field name="res_model">l10n_ar.impuestos.deduccion</field>
        <field name="view_mode">tree</field>
        <field name="domain">[('tax','=','arba')]</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Subdiario Compras - WINDOW -->
    <record id="action_accountancy_journals_purchases" model="ir.actions.act_window">
        <field name="name">Subdiario Compras</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <field name="context">{ 'search_default_purchases': 1, 'search_default_group_by_move': 1, 'expand': 1 }</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Subdiario Ventas - WINDOW -->
    <record id="action_accountancy_journals_sales" model="ir.actions.act_window">
        <field name="name">Subdiario Ventas</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <!-- https://github.com/odoo/odoo/blob/0097b4a4c6dcb9f66d89316476f6c65fcb998ecd/addons/account/views/account_move_views.xml#L342 -->
        <field name="context">{ 'search_default_sales': 1, 'search_default_group_by_move': 1, 'expand': 1 }</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Subdiario Banco - WINDOW -->
    <record id="action_accountancy_journals_bank" model="ir.actions.act_window">
        <field name="name">Banco</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <!-- https://github.com/odoo/odoo/blob/0097b4a4c6dcb9f66d89316476f6c65fcb998ecd/addons/account/views/account_move_views.xml#L342 -->
        <field name="context">{ 'search_default_bank': 1, 'search_default_group_by_move': 1, 'expand': 1 }</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Subdiario Caja - WINDOW -->
    <record id="action_accountancy_journals_cash" model="ir.actions.act_window">
        <field name="name">Caja</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <!-- https://github.com/odoo/odoo/blob/0097b4a4c6dcb9f66d89316476f6c65fcb998ecd/addons/account/views/account_move_views.xml#L342 -->
        <field name="context">{ 'search_default_cash': 1, 'search_default_group_by_move': 1, 'expand': 1 }</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- Subdiario Varios - WINDOW -->
    <record id="action_accountancy_journals_misc" model="ir.actions.act_window">
        <field name="name">Varios</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <!-- https://github.com/odoo/odoo/blob/0097b4a4c6dcb9f66d89316476f6c65fcb998ecd/addons/account/views/account_move_views.xml#L342 -->
        <field name="context">{ 'search_default_misc_filter': 1, 'search_default_group_by_move': 1, 'expand': 1 }</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <!-- AFIP Mis Retenciones - WINDOW -->
    <record id="action_taxes_afip_retenciones" model="ir.actions.act_window">
        <field name="name">AFIP - Mis Retenciones</field>
        <field name="res_model">l10n_ar.impuestos.deduccion</field>
        <field name="view_mode">tree</field>
        <field name="domain">[('tax','=','iva')]</field>
        <field name="target">main</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <record id="action_configuration_impuestos" model="ir.actions.act_window">
        <field name="name">Impuestos</field>
        <field name="res_model">account.tax</field>
        <field name="view_mode">list</field>
    </record>

    <!-- TODO: Mover a un archivo propio -->
    <record id="action_configuration_grupo_impuestos" model="ir.actions.act_window">
        <field name="name">Grupos de Impuestos</field>
        <field name="res_model">account.tax.group</field>
        <field name="view_mode">list</field>
    </record>

    <record id="view_account_journal_creditdebit" model="ir.ui.view">
        <field name="name">account.journal.creditdebit</field>
        <field name="model">account.journal</field>
        <field name="inherit_id" ref="account.view_account_journal_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='loss_account_id']" position="after">
                <field name="payment_debit_account_id" />
                <field name="payment_credit_account_id" />
            </xpath>
        </field>
    </record>

    <!-- Empresas/Contabilidad/Subdiarios-->
    <record id="view_account_journal_creditdebit" model="ir.ui.view">
        <field name="name">account.move.line.pyme</field>
        <field name="model">account.move.line</field>
        <field name="inherit_id" ref="account.view_move_line_tree_grouped" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='company_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='move_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='matching_number']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='move_id']" position="after">
                <field name="account_id" />
            </xpath>
        </field>
    </record>

</odoo>