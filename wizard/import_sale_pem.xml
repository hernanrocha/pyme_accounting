<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- IMPORTAR VENTAS PEM - FORM VIEW -->
    <record id="view_wizard_import_sale_pem_form" model="ir.ui.view">
        <field name="name">l10n_ar.import.sale.pem.form</field>
        <field name="model">l10n_ar.import.sale.pem</field>
        <field name="arch" type="xml">
            <form>
                
                <div class="card bg-primary">
                    <div class="card-body">
                        <p>Existen 2 tipos de archivos que pueden ser importados:</p>
                        <ul>
                            <li>F8010: importar comprobantes individuales.</li>
                            <li>F8011: importar comprobantes Z</li>
                        </ul>
                        <p>Por el momento, el sistema solo permite importar el archivo F8011.</p>
                        <p>Se generará un comprobante por cada Z, comúnmente generado al finalizar cada día.</p>
                    </div>
                </div>

                <group string="Archivo" col="2">

                    <field name="f8010_file" />
                    <field name="f8011_file" />
                
                </group>

                <!-- Datos del F8010 -->
                <group string="Datos Cargados" col="4" attrs="{'invisible': [('f8010_pos', '=', 0)]}">
                    <field name="f8010_cuit" />
                    <field name="f8010_pos" />
                    <field name="f8010_start_date" />
                    <field name="f8010_end_date" />
                </group>

                <field name="f8010_invoice_ids" mode="tree" widget="section_and_note_one2many" 
                    readonly="1" attrs="{'invisible': [('f8010_pos', '=', 0)]}">                                                
                    <tree>
                        <field name="number" />
                        <field name="date" />
                        <field name="description" />
                        <field name="taxed_21" />
                        <field name="tax_21" />
                        <field name="taxed_6" optional="hide" />
                        <field name="tax_6" optional="hide" />
                        <field name="untaxed" />
                        <field name="exempt" />
                        <field name="total" />
                    </tree>
                </field>

                <!-- Datos del F8011 -->
                <group string="Datos Cargados" col="4" attrs="{'invisible': [('f8011_pos', '=', 0)]}">
                    <field name="f8011_cuit" />
                    <field name="f8011_pos" />
                    <field name="f8011_start_date" />
                    <field name="f8011_start_number" />
                    <field name="f8011_end_date" />
                    <field name="f8011_end_number" />
                </group>

                <field name="invoice_ids" mode="tree" widget="section_and_note_one2many" 
                    readonly="1" attrs="{'invisible': [('f8011_pos', '=', 0)]}">                                                
                    <tree>
                        <field name="number" />
                        <field name="range" />
                        <field name="date" />
                        <field name="taxed" />
                        <field name="taxed_6" optional="hide" />
                        <field name="untaxed" />
                        <field name="exempt" />
                        <field name="tax_6" optional="hide" />
                        <field name="tax_21" />
                        <field name="total" />
                    </tree>
                </field>

                <!-- TODO: Agregar una nota diciendo que el IVA 6% se va a convertir a 21% y No Gravado -->
                <!-- TODO: Agregar campos z_desde y z_hasta -->

                <footer>
                    <button name="compute_f8010" string="Cargar F8010" type="object" class="btn-primary" />
                    <!-- TODO: convertir a action -->
                    <!-- TODO: Fusionar botones -->
                    <button name="compute_f8011" string="Cargar F8011" type="object" class="btn-primary" />
                    <button name="generate_f8011" string="Generar Facturas" type="object" class="btn-primary" 
                        attrs="{'invisible': [('f8011_pos', '=', 0)]}" />
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- IMPORTAR VENTAS PEM - WINDOW ACTION -->
    <record id="action_wizard_import_sale_pem" model="ir.actions.act_window">
        <field name="name">Importar Ventas de Controlador Fiscal</field>
        <field name="res_model">l10n_ar.import.sale.pem</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

</odoo>