<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- IMPORTAR COMPROBANTES RECIBIDOS - FORM VIEW -->
    <record id="view_wizard_import_purchases_comp_recibidos_form" model="ir.ui.view">
        <field name="name">l10n_ar.import.purchase.comprecibidos.form</field>
        <field name="model">l10n_ar.import.purchase.comprecibidos</field>
        <field name="arch" type="xml">
            <form>
                
                <!-- <p><b>NOTA: La diferencia entre el monto total y los otros importes detallados a continuación, serán cargados como monto no gravado. Estos montos en general suelen corresponder a percepciones aplicadas al comprobante, y pueden ser modificadas desde Importar - IIBB - Deducciones</b></p> -->

                <!-- <div class="card bg-primary">
                    <div class="card-body">
                        <p>Existen 2 tipos de archivos que pueden ser importados:</p>
                        <ul>
                            <li>F8010: importar comprobantes individuales.</li>
                            <li>F8011: importar comprobantes Z</li>
                        </ul>
                        <p>Por el momento, el sistema solo permite importar el archivo F8011.</p>
                        <p>Se generará un comprobante por cada Z, comúnmente generado al finalizar cada día.</p>
                    </div>
                </div> -->

                <group string="Archivo" col="2">

                    <field name="file" />
                
                </group>

                <separator string="Datos Cargados" />
                <notebook>
                    <page string="Facturas">

                        <field name="invoice_ids" widget="section_and_note_one2many" options="{'reload_on_button': true}">
                            <tree 
                                default_order="invoice_found, vendor, date"
                                decoration-success="match_total_amount">
                                
                                <field name="match_total_amount" invisible="1" />

                                <field name="invoice_found" />
                                <field name="date" edit="false" />
                                <field name="cuit" />
                                <field name="vendor" />
                                <field name="invoice_display_name" />
                                <field name="taxed_amount" />
                                <field name="untaxed_amount" />
                                <field name="exempt_amount" />
                                <field name="iva_type" />
                                <field name="iva" />
                                <field name="difference" />
                                <field name="total" />
                                <field name="invoice_amount_total" />
                            </tree>
                        </field>
                    </page>

                    <page string="Otras facturas">
                        <field name="existing_invoice_ids" nolabel="1" widget="section_and_note_one2many" options="{'reload_on_button': true}">
                            <tree default_order="invoice_partner_display_name, name">
                                <field name="state" invisible="1" />

                                <field name="date" />
                                <field name="name" />
                                <field name="cuit" />
                                <field name="invoice_partner_display_name" />
                                <field name="display_amount_taxed" sum="Total" />
                                <field name="display_amount_untaxed" sum="Total" />
                                <field name="display_amount_exempt" sum="Total" />
                                <field name="display_amount_total" sum="Total" />
                            </tree>
                        </field>
                    </page>
                </notebook>

                <footer>
                    <!-- TODO: convertir a action -->
                    <button name="compute" string="Cargar" type="object" class="btn-primary" />
                    <button name="generate" string="Generar Facturas" type="object" class="btn-primary" /> 
                        <!-- TODO attrs="{'invisible': [('loaded', '=', True)]}" /> -->
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- IMPORTAR COMPROBANTES RECIBIDOS - WINDOW ACTION -->
    <record id="action_import_purchases_comp_recibidos" model="ir.actions.act_window">
        <field name="name">Importar Compras de Comprobantes Recibidos</field>
        <field name="res_model">l10n_ar.import.purchase.comprecibidos</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

</odoo>