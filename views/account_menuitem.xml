<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- TODOs:
        - Borrar Conversaciones, Calendario, Contactos, Empleados??, Ausencias??, Tableros??
        - Reemplazar Facturacion/Contabilidad por Mi Estudio y Empresa??
        - Mi Estudio:
            - Agregar "autochange company"
            - Actividades: no tiene permisos
            - Clientes: no aparece la lista ni se puede editar
        - Ventas: 
            - Comprobantes: agregar columnas faltantes
            - Clientes: filtrar por compañia y mostrar solo la lista
        - Contabilidad:
            - Agregar menus faltantes
        - Importar:
            - Agregar permiso a los import habilitados
        - Informes:
            - Terminar Reporte Monotributo
            - Terminar Reporte IIBB
            - Terminar Libro IVA Digital
    -->


    <!-- TODO: Crear menu diferente para Mi estudio -->
    <!-- TODO: Crear menu diferente para Clientes -->

    <!-- TODO: Deshabilitar menu Facturacion -->
    <!-- <menuitem id="account.menu_finance" name="Facturación" /> -->

    <menuitem name="Mi Estudio"
        id="menu_miestudio"
        groups="account.group_account_readonly,account.group_account_invoice"
        web_icon="account,static/description/icon.png"
        sequence="41">
    </menuitem>

    <menuitem name="Empresas"
        id="menu_finance"
        groups="account.group_account_readonly,account.group_account_invoice"
        web_icon="account,static/description/icon.png"
        sequence="42">
    </menuitem>

    <record id="view_account_invoice_filter" model="ir.ui.view">
    <field name="name">account.invoice.select</field>
    <field name="model">account.move.line</field>
    <field name="arch" type="xml">
        <search string="Search Invoice">
            <field name="date" string="Period"/>
            <filter string="ARBA" name="filter_tax_tag_ids"
                domain="[('tax_tag_ids', 'contains', 'ARBA')]" />
            <filter name="filter_date" date="date" string="Fecha" default_period="last_month" />
            <!-- <filter domain="[('invoice_user_id', '=', uid)]" name="myinvoices" help="My Invoices"/>
            <separator/>
            <filter name="draft" string="Draft" domain="[('state','=','draft')]"/>
            <filter name="posted" string="Posted" domain="[('state', '=', 'posted')]"/>
            <filter name="cancel" string="Cancelled" domain="[('state', '=', 'cancel')]"/>
            <separator/>
            <filter string="To Check" name="to_check" domain="[('to_check', '=', True)]"/>
            <separator/>
            <filter name="in_payment" string="In Payment" domain="[('payment_state', '=', 'in_payment'), ('state', '=', 'posted')]"/>
            <filter name="partial" string="Partially Paid" domain="[('payment_state', '=', 'partial'), ('state', '=', 'posted')]"/>
            <filter name="paid" string="Paid" domain="[('payment_state', '=', 'paid'), ('state', '=', 'posted')]"/>
            <filter name="unpaid" string="Not Paid" domain="[('payment_state', '=', 'not_paid'), ('state', '=', 'posted')]"/>
            <filter name="reversed" string="Reversed" domain="[('payment_state', '=', 'reversed'), ('state', '=', 'posted')]"/>
            <filter name="late" string="Overdue" domain="['&amp;', ('invoice_date_due', '&lt;', time.strftime('%%Y-%%m-%%d')), ('state', '=', 'posted'), ('payment_state', 'in', ('not_paid', 'partial'))]" help="Overdue invoices, maturity date passed"/>
            <separator/>
            <filter name="invoice_date" string="Invoice Date" date="invoice_date"/>
            <filter name="due_date" string="Due Date" date="invoice_date_due"/>
            <separator/>
            <filter invisible="1" string="Late Activities" name="activities_overdue"
                domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                help="Show all records which has next action date is before today"/>
            <filter invisible="1" string="Today Activities" name="activities_today"
                domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
            <filter invisible="1" string="Future Activities" name="activities_upcoming_all"
                domain="[('activity_ids.date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))]"/> -->
            <group expand="1" string="Agrupar P...">
                <!-- <filter string="Salesperson" name="salesperson" context="{'group_by':'invoice_user_id'}"/> -->
                <filter name="group_account_id" string="Cuenta" context="{'group_by':'account_id'}"/>
                <separator/>
                <!-- parent_state -->
                <!-- <filter string="Invoice Date" name="invoicedate" context="{'group_by': 'invoice_date'}"/>
                <filter string="Due Date" name="duedate" context="{'group_by': 'invoice_date_due'}"/> -->
            </group>
        </search>
    </field>
</record>
    
    <!-- Asientos IIBB -->
    <record id="action_iibb_arba_asientos" model="ir.actions.act_window">
        <field name="name">Asientos IIBB</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree</field>
        <!-- <field name="context">{}</field> -->
        <!-- <field name="view_id" ref="view_iibb_arba_asientos_tree" /> -->
        <field name="search_view_id" ref="view_account_invoice_filter"></field>
        <field name="context">{'search_default_group_account_id': 1, 'search_default_filter_date': 1}</field>
        <field name="domain">[]</field>
        <field name="target">main</field>
    </record>

    <!-- Reportes -->
    <record id="action_tax_report" model="ir.actions.act_window">
        <field name="name">Reportes</field>
        <field name="res_model">account.tax.report</field>
        <field name="view_mode">list</field>
        <!-- <field name="context">{}</field> -->
        <!-- <field name="view_id" ref="view_iibb_arba_asientos_tree" /> -->
        <field name="target">main</field>
    </record>

    <!-- MENU Mi Estudio/Mi Estudio  -->
    <menuitem id="menu_firm" name="Mi Estudio" parent="menu_miestudio" sequence="1">
        <!-- MENU Facturacion/Mi Estudio/Mis Datos  -->
        <menuitem name="Mis Datos" sequence="1" 
            id="menu_firm_company" action="action_firm_company" />
        
        <!-- MENU Facturacion/Mi Estudio/Actividades  -->
        <menuitem name="Actividades" sequence="2" 
            id="menu_firm_activities" action="action_firm_activities" />

        <!-- TODO: MENU Facturacion/Mi Estudio/Actividades  -->
        <!-- <menuitem name="Calendario" sequence="3" 
            id="menu_firm_calendar" action="action_firm_calendar" /> -->

        <!-- MENU Facturacion/Mi Estudio/Clientes  -->
        <menuitem name="Clientes" sequence="4" 
            id="menu_firm_clients" action="action_firm_clients" />
        
        <!-- TODO: MENU Facturacion/Mi Estudio/Emails  -->
        <!-- <menuitem name="Emails Enviados" sequence="5" 
            id="menu_firm_email_sent" action="action_firm_email_sent" /> -->

        <!-- TODO: Agregar Calendario (y cumpleaños) -->
    </menuitem>

    <!-- TODO: MENU Facturacion/Dashboard
        Dashboard:
        - [Monotributo]: categoria actual, actividades, inicio de actividades (boton para conectar con AFIP)

        - Compras y Ventas en grafico de barras (ultimos 12 meses)
        - Compras y Ventas en tabla (ultimos 12 meses)
        - [Monotributo] mostrar categoria calculada, limite, pago
    -->

    <record id="open_account_journal_dashboard_kanban" model="ir.actions.act_window">
        <field name="name">Accounting Dashboard</field>
        <field name="res_model">account.journal</field>
        <field name="view_mode">kanban,form</field>
        <field name="view_id" ref="account.account_journal_dashboard_kanban_view"/>
        <field name="usage">menu</field>
        <field name="context">{'search_default_dashboard':1}</field>
        <field name="domain">[]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_neutral_face">
                This is the accounting dashboard
            </p>
        </field>
    </record>

    <!-- MENU Facturacion/Dashboard -->
    <menuitem id="menu_dashboard" name="Dashboard" parent="menu_finance" sequence="1" action="open_account_journal_dashboard_kanban" />
    <!-- TODO: Borrar diarios creados por defecto que no se usan: Ventas preimpreso -->
    <!-- TODO: sacar botones que no se usen. CF seria readonly -->
    <!-- TODO: hacer graficos por mes y no por cobros -->

    <!-- MENU Facturacion/Ventas -->
    <menuitem id="menu_sales" name="Ventas" parent="menu_finance" sequence="2">
        <menuitem id="menu_action_move_out_invoice_type" name="Comprobantes Emitidos" action="action_move_out_invoice_type" sequence="1"/>
        <!-- TODO: Unificar estos 2 -->
        <menuitem id="menu_action_move_out_refund_type" name="Notas de Crédito" action="action_move_out_refund_type" sequence="2"/>
        <!-- <menuitem id="menu_action_move_out_receipt_type" action="action_move_out_receipt_type" groups="account.group_sale_receipts" sequence="3"/> -->
        <!-- <menuitem id="menu_action_account_payments_receivable" action="action_account_payments" sequence="15"/> -->
        <menuitem id="product_product_menu_sellable" name="Productos" action="account.product_product_action_sellable" sequence="100"/>
        <menuitem id="menu_account_customer" name="Clientes" action="account.res_partner_action_customer" sequence="110"/>
    </menuitem>

    <!-- MENU Facturacion/Compras --> 
    <menuitem id="menu_finance_payables" name="Compras" parent="menu_finance" sequence="3">
        <menuitem id="menu_action_move_in_invoice_type" name="Comprobantes Recibidos" action="action_move_in_invoice_type" sequence="1"/>
        <!-- TODO: Los proveedores no pueden ser compartidos. Aparecen todos los proveedores al momento de crear una factura -->
        <!-- TODO: Unificar estos 2 -->
        <menuitem id="menu_action_move_in_refund_type" action="action_move_in_refund_type" sequence="2"/>
        <!-- <menuitem id="menu_action_move_in_receipt_type" action="action_move_in_receipt_type" groups="account.group_purchase_receipts" sequence="3"/> -->
        <!-- <menuitem id="menu_action_account_payments_payable" action="action_account_payments_payable" sequence="20"/> -->
        <menuitem id="product_product_menu_purchasable" name="Productos" action="account.product_product_action_purchasable" sequence="100"/>
        <menuitem id="menu_account_supplier" name="Proveedores" action="account.res_partner_action_supplier" sequence="200"/>
    </menuitem>

    <!-- MENU Facturacion/Contabilidad  -->
    <menuitem id="menu_accountancy" name="Contabilidad" parent="menu_finance" sequence="4">

        <!-- MENU Facturacion/Contabilidad/Subdiarios-->
        <menuitem id="menu_accountancy_journals" name="Subdiarios" sequence="1">
                
            <!-- MENU Facturacion/Contabilidad/Subdiarios/Compras -->
            <menuitem id="menu_accountancy_journals_purchases" name="Compras" 
                sequence="1" action="report_basic" />

            <!-- MENU Facturacion/Contabilidad/Subdiarios/Ventas -->
            <menuitem id="menu_accountancy_journals_sales" name="Ventas" 
                sequence="2" action="report_basic" />
                
        </menuitem>
        
        <!-- TODO:
            - Asientos Manuales
            - Libro Diario
            - Libro Mayor
            - Resultados Mensuales
            - Cierre de Ejercicio
        -->

    </menuitem>       

    <!-- MENU Facturacion/Importar  -->
    <menuitem id="menu_import" name="Importar" parent="menu_finance" sequence="10">

        <!-- MENU Facturacion/Importar/Compras -->
        <menuitem id="menu_import_purchases" name="Compras" sequence="1">

            <!-- TODO: Borrar este y dividir en 2 partes -->
            <!-- MENU Facturacion/Importar/Compras/AFIP-ARBA  -->
            <menuitem name="Importar AFIP" sequence="1"
                id="menu_import_afip" action="action_arba_afip_upload"/>

            <!-- TODO -->
            <!-- MENU Facturacion/Importar/Compras/Comprobantes Emitidos  -->
            <menuitem name="Mis Comprobantes Recibidos" sequence="1" 
                id="menu_import_purchases_comp_recibidos" action="action_move_in_invoice_type" />
                
            <!-- <menuitem name="Archivo RG3685" sequence="3" 
                id="menu_import_purchases_rg3685" action="action_move_in_invoice_type" /> -->

            <menuitem name="Archivo Excel" sequence="4" 
                id="menu_import_purchase_excel" action="action_import_purchase_excel" />

            <!-- TODO: Definir actividad para importar productos (Pto Vta o Producto) -->

        </menuitem>

        <!-- MENU Facturacion/Importar/Ventas -->
        <menuitem id="menu_import_sales" name="Ventas" sequence="2">

            <!-- MENU Facturacion/Importar/Ventas  -->
            <menuitem name="Mis Comprobantes Emitidos" sequence="2"
                id="menu_import_sales_comp_emitidos" action="action_afip_import_sale_wizard" />
                            
            <!-- TODO: MENU Facturacion/Importar/Ventas  -->
            <!-- <menuitem name="Comprobantes en Linea" sequence="3"
                id="menu_import_sale_compenlinea" action="action_wizard_import_sale_compenlinea" /> -->
                
            <!-- TODO: MENU Facturacion/Importar/Retenciones AFIP  -->
            <!-- <menuitem name="[RevisarNombre] Retenciones AFIP" sequence="9" 
                id="menu_import_sale_rg3685" action="action_wizard_import_sale_pem" /> -->

            <!-- MENU Facturacion/Importar/Controlador Fiscal (*.PEM) -->
            <menuitem name="Archivo Controlador Fiscal (*.PEM)" sequence="4" 
                id="menu_import_sale_pem" action="action_wizard_import_sale_pem" />
            
            <!-- MENU Facturacion/Importar/Archivo Excel -->
            <menuitem name="Archivo Excel" sequence="6" 
                id="menu_import_sale_excel" action="action_import_sale_excel" />
            
            <!-- 
                TODO: Proveedor, Fecha Factura/Contable/Vencimiento, Diario, Tipo de doc, Numero de Doc. 
                Producto, Descripcion, Cuenta, Cantidad, Precio, Impuestos (IVA, IIBB)
            -->
                
            <!-- <menuitem name="Ventas de MercadoLibre" sequence="7" 
                id="menu_import_sale_meli" action="action_wizard_import_sale_pem" /> -->

            <!-- <menuitem name="Ventas de MP, etc" sequence="8" 
                id="menu_import_sale_meli" action="action_wizard_import_sale_pem" /> -->

            <!-- <menuitem name="Archivo RG3685" sequence="9" 
                id="menu_import_sale_rg3685" action="action_wizard_import_sale_pem" /> -->

        </menuitem>

        <menuitem id="menu_import_iibb" name="IIBB" sequence="3">
            <!-- MENU Facturacion/Importar/Compras/Deducciones ARBA -->
            <menuitem name="Deducciones ARBA" sequence="1" 
                id="menu_import_purchase_deducciones_arba" action="action_import_purchase_deducciones_arba" />

        </menuitem>

        <!-- MENU Facturacion/Importar/Banco -->
        <menuitem id="menu_import_bank" name="Bancos" sequence="4">
                
            <!-- MENU Facturacion/Importar/Banco/Resumen Bancario -->
            <menuitem name="Resumen Banco Provincia" sequence="2"
                id="menu_import_bank_bapro" action="action_import_bank_bapro" />

        </menuitem>

    </menuitem>

    <!-- MENU Facturacion/Informes  -->
    <menuitem id="menu_taxes" name="Informes" parent="menu_finance" sequence="11">

        <!-- MENU Facturacion/Informes/Monotributo-->
        <menuitem id="menu_reports_monotributo" name="Monotributo" sequence="1">

            <!-- MENU Facturacion/Informes/Monotributo/Reporte Mensual-->
            <menuitem id="menu_taxes_report_monotributo_mensual" name="Reporte Mensual" 
                sequence="1" action="report_basic" />

            <!-- MENU Facturacion/Informes/Monotributo/Reporte Ultimos 12 Meses-->
            <menuitem id="menu_taxes_report_monotributo_anual" name="Últimos 12 Meses"
                sequence="2" action="report_basic" />

            <!-- TODO: compras y ventas de los ultimos 12 meses. Categoria, pago mensual, max categoria -->

        </menuitem>      
        
        <!-- MENU Facturacion/Impuestos/IIBB -->
        <menuitem id="menu_taxes_iibb" name="Ingresos Brutos" sequence="3">
        
            <!-- MENU Facturacion/Impuestos/IIBB/ARBA  -->
            <!-- <menuitem name="Asientos IIBB" sequence="1"
                id="menu_iibb_arba_asientos" action="action_iibb_arba_asientos"/> -->

            <!-- MENU Facturacion/Impuestos/IIBB/ARBA  -->
            <menuitem name="DD.JJ. ARBA" sequence="2"
                id="menu_taxes_iibb_arba" action="action_iibb_arba_wizard"/>

            <!-- MENU Facturacion/Impuestos/IIBB/ARBA  -->
            <menuitem name="Reportes" sequence="3"
                id="menu_tax_report" action="action_tax_report"/>

            <!-- TODO: la alicuota puede ser cualquier valor. -->

            <!-- MENU Facturacion/Impuestos/IIBB/SIFERE  -->
            <!-- <menuitem name="Convenio Multlateral" sequence="4"
                id="menu_tax_sifere" action="action_tax_report"/> -->
        </menuitem>
        
        <menuitem id="menu_reports_afip" name="AFIP" sequence="5">

            <!-- MENU Facturacion/Informes/AFIP/Reporte Mensual-->
            <!-- TODO: Compras (ALICUOTA, CBTE), Ventas (ALICUOTA, CBTE), TURIVA -->
            <menuitem id="menu_taxes_report_afip_iva_digital" name="Libro IVA Digital" 
                sequence="1" action="report_basic" />
            <!-- TODO: 
                - Sacar "Anomimo"
                - Sacar acentos en el nombre
                - En los comprobantes Z, poner el desde/hasta de los comprobantes individuales, 
                para no exceder el monto maximo permitido por comprobante
            -->

            <!-- MENU: Facturacion/Informes/AFIP/DD. JJ. IVA -->
            <menuitem id="menu_taxes_report_afip_iva_web" name="DD. JJ. IVA (F. 2002)" 
                sequence="2" action="report_basic" />


            <!-- MENU Facturacion/Informes/AFIP/Reporte Ultimos 12 Meses-->
            <!-- <menuitem id="menu_taxes_report_afip_anual" name="Últimos 12 Meses"
                sequence="2" action="report_basic" /> -->

            <!-- TODO: SIRE -->

            <!-- TODO: Chequear estado de AFIP (WebService + reporte de caido)-->

            <!-- TODO: Vista de Puntos de Venta en AFIP (opcion a traerlos configurandolo) -->

        </menuitem>  

    </menuitem>

    <!-- TODO:
        Mi Estudio:
        - Estudio
        - Empresas: nombre, alias, CUIT (consultar por CUIT, tramitar WS, constancia),
            resp ante AFIP, ARBA, bancos, 
            - Periodos fiscales (autogenerar?). Solo un admin puede reabrirlo. Chequear al importar datos
            - Cuentas bancarias: codigos y nombre. => son los diarios banco
            - Compras/Ventas: tipo de actividad
              - Ordenar por Proveedor-Fecha o Fecha-Proveedor
              - Validar Factura en AFIP
        - Actividades: propios de la empresa principal

        Ventas:
        - Cobros

        Compras:
        - Pagos
    -->

    <!-- CONTABILIDAD:
        - Subdiario Compras: <ventas>, Perc. IIBB, Perc. IVA, Perc. Ganancias
        - Subdiario Ventas: Fecha, CUIT, Proveedor, Factura, Total, Gravado, IVA, No Gravado, Exento
          Si sos agente de percepcion, tambien van las columnas de perc.
          Todo separado por actividad
        - Asientos manuales: modelos de asientos para:
          - devengamiento de impuestos (IIBB, IVA, TSH)
          - compras, ventas (1 solo mensual)
          - caja, banco, anulacion de movimientos entre caja/banco
          - sueldos
          - apertura, refundicion de resultados, cierre
        - Libro Mayor (como esta)
        - Cuenta corriente de proveedores (libro mayor de empresa, filtro por proveedores)
        - Cuenta corriente de clientes (libro mayor de empresa, filtro por clientes)
        - Estados de los asientos: "Borrador", "Confirmado", "Cancelado"
        - Plan de Cuentas: editable
            - cuentas separadas por rubro (sub cuentas?)
            - renombrar "Valor neto" a "Patrimonio Neto"
        - Activos (no se dice asi) 
            => Bienes de uso: 
                - nombre
                - categoria (muebles y utiles, maquinaria, equipos de computacion)
                  Cada categoria tiene reglas por ley sobre la amortizacion
        - Extracto Bancario y conciliacion bancaria
        - Cheques
        - Fecha Tope
        - Informes: Estado de Resultados, Balance de Sumas y Saldos (OCA esta bien), balance integrado
        - Renombrar "Tipos de Documento" a "Tipos de Comprobante" (solo lectura)
        - Diarios contables: NO. Convertir a "Puntos de Venta"
        - Posiciones fiscales: NO
    -->

</odoo>
